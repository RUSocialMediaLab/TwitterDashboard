

<!DOCTYPE html>
<html>
<head>
  <title>Learning Analytics Dashboard</title>
  <meta charset="utf-8" name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
 
    <script src="http://d26b395fwzu5fz.cloudfront.net/3.3.0/keen.min.js"></script>
  <script src="//d26b395fwzu5fz.cloudfront.net/keen-analysis-1.2.2.js"></script>
   

  <link href="//d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.css" rel="stylesheet" />
  <script src="//d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.js"></script>
  <link rel="stylesheet" type="text/css" href="../assets/lib/bootstrap/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../assets/css/keen-dashboards.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.css" rel="stylesheet" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>
 

</head>
<body class="application">
<div class="navbar navbar-inverse navbar-fixed-top" style="height:800;" role="navigation">
          <a class="navbar-brand" style="margin-top:10px" href="http://socialmedialab.ca/"><img alt="Social Media Lab" height="60" width="225" src="http://socialmedialab.ca/wp-content/uploads/2016/11/Social_Media_Lab_Ryerson_TRSM_logo2016-1.png" >
</a>
   <a class="navbar-brand" href="./"><h2>Learning Analytics Dashboard</h2><h4>Hashtag: #bus5569F17</h4></a> 
   <br><br><br><br><br> 
  </div>  

<div >
    <br><br><br><br<br>
    <font size=4 weight=bold>Posting Frequency
    <div class="row">
      <div class="col-sm-8">
        <div class="chart-wrapper">
            <div class="chart-stage" id="total_chart">
            </div>
          <div class="chart-stage" id="post_line">
          </div>
          <div class="chart-notes">
             The total number of tweets each day using the hashtag #bus5569F17  
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="hour_chart">
          </div>
          <div class="chart-notes">
          The total number of tweets each  hour using the hashtag #bus5569F17
           </div>
        </div>
      </div>
   </div>
   <font size=4 weight=bold>Content Descriptions 
   <div class="row">
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="con_chart">
          </div>
          <div class="chart-notes">
             Users can post various content, including hashtags, urls, user handles, multi-media or regular text. 
            The height of the graph represents the whole number of tweets for a particular day. Each coloured segment or <i>stack</i> represents a category (in this case the number of tweets with urls, hashtags, media, or user handles) that make up parts of the whole.   

</div>
        </div>
      </div>
    <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
            <div class="chart-stage" id="eng_chart">
          </div>
          <div class="chart-notes">
             Twitter users can create an original post, or retweet or reply to an existing tweet. The height of each bar represents the whole number of tweets for a particular day. Each coloured segment or <i>stack</i> represents a category (in this case the number of tweets that are replies, retweets, or original) that make up parts of the whole. 
          <br><br></div>
        </div>
      </div>
           <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="spline_chart">
          </div>
          <div class="chart-notes">
              Sentiment describes the emotionality of the tweet, and whether it is positive, negative or neutral. <br> 
       We use the <a href="http://www.nltk.org/api/nltk.sentiment.html" >NLTK SentimentAnalyzer </a>, a Python package to implement and facilitate Sentiment Analysis tasks using NLTK features and classifiers. 
          <br> <br></div>
        </div>
      </div> 
   </div>    


<div class="row">
     <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="sub_chart">
          </div>
          <div class="chart-notes">
             Subjectivity is the degree of factuality or opinionated language in tweets. To calculate the subjectivity of sentences, we use the <a href="http://www.nltk.org/api/nltk.sentiment.html">NLTK subjectivity classifier</a>, trained on the Subjectivity Dataset (Pang & Lee, 2004).
          </div>
        </div>
      </div>
   <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="hashtag_table">
          </div>
          <div class="chart-notes">
             Hashtags contained in the tweet (excluding #bus5569F17)<br><br><br>
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-stage" id="ne_chart" >
          </div>
          <div class="chart-notes">
           Named entities are proper names of persons, places, or organizations<br><br><br>
           </div>
        </div>
      </div>
    </div>
  </div>
 

   User Information 
  <div class="row">
  <div class="col-sm-12 col-md-3">
        <div class="chart-wrapper">
          <div class="chart-stage" id="column_chart" >
          </div>
          <div class="chart-notes">
              Twitter users who post, retweet or reply most frequently 
          </div>
        </div>
      </div>
      <div class="col-sm- col-md-3">
        <div class="chart-wrapper">
          <div class="chart-stage" id="sentbar_chart" >
          </div>
          <div class="chart-notes" >
              Users with most negative sentiment 
          </div>
        </div>
      </div>
      <div class="col-sm-12 col-md-3">
        <div class="chart-wrapper">
          <div class="chart-stage" id="subbar_chart">
          </div>
          <div class="chart-notes">
               Users  with most positive sentiment 
          </div>
        </div>
      </div>
       <div class="col-sm-12 col-md-3">
        <div class="chart-wrapper">
          <div class="chart-stage" id="mentions_chart">
          </div>
          <div class="chart-notes">
               Users most mentioned 
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>

   <div class="row">
  <div class="col-sm-6 col-md-12">
        <div class="chart-wrapper">
          <div class="chart-stage" id="text_ext" >
          </div>
          <div class="chart-notes">
              Full text of all Twitter posts today using the course hashtag 
          </div>
        </div>
      </div>

    </div>
  </div>
  </div> 


  </div>
  </div>

  </div>

</div>
   <!-- <p class="small text-muted">Built with &#9829; by Nadia</a></p>
-->
  <script>
var client = new Keen({
       projectId: "595658e654532c69a434e36c",
        readKey: "561BB911CF7338D0713A81E057B8F15AEB2B0FEB99AA9593DB28C6CDA36474BAF23DAC275023D2BF91D4FE581A4D5267AFD693E87AB45748EFFCEDE14F6A372203692DADA7A9F821E9217A6BC8B1265917D602A0C64331EB523FB64976FE5202"
     });  



var postchart = new Keen.Dataviz()
  .el('#post_line')
  .type("area")
  .height(300)
  .title("Posts (last 7 days)")
  .prepare();

var postquery= new Keen.Query("count", {
    event_collection: 'bus5569F17',
    interval: "daily",
    timeframe: 'previous_7_days',
    refresh_rate:3600,
    timezone: "US/Eastern"
  });


client.run(postquery, function(err, res){
     postchart
     .data(res)
     .render();
 });


var totalchart = new Keen.Dataviz()
  .el('#total_chart')
  .type("metric")
  .title("Total posts this term")
  .width(180)
;

var totalquery= new Keen.Query("count",{
   event_collection: "bus5569F17",
   timeframe: "this_2_years",
   refresh_rate:3600,
   timezone: "US/Eastern" });

client

.run (totalquery, function(err,res){
   totalchart
   .data(res)
   .render();
});


var hourchart = new Keen.Dataviz()
  .el('#hour_chart')
  .type("bar")
  .height(450)
  .title("Total posts made today, per hour")
  .colors(['purple'])
  .prepare();

var hourquery= new Keen.Query("count", {
    event_collection: 'bus5569F17',
    interval: "hourly",
    timeframe: 'this_1_days',
    refresh_rate:3600,
    timezone: "US/Eastern"
  });

client.run(hourquery, function(err, res){
     hourchart
      .data(res)
      .render();
    });




Keen.ready(function(){

var sq1 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  target_property: 'sentiment_range',
  filters: [
          {
            property_name: "sentiment_range",
            operator : "eq",
            property_value : "positive"
          }
        ]
});

var sq2 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  target_property: 'sentiment_range',
  filters: [
          {
            property_name: "sentiment_range",
            operator : "eq",
            property_value : "negative"
          }
        ]
});

var sq3 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  timezone: "US/Eastern",
  refresh_rate: 3600,
  interval: 'daily',
  target_property: 'sentiment_range',
  filters: [
          {
            property_name: "sentiment_range",
            operator : "eq",
            property_value : "neutral"
          }
        ]
});



var sentchart = new Keen.Dataviz()
  .el('#spline_chart')
  .title('Sentiment type (last 7 days)')
  .height(300)
  .type("spline")
  .colors(['red','green','blue'])
  .prepare();

client.run([sq1, sq2, sq3 ], function(err, res) {
  sentchart
    .data(res[0])
    .labelMapping({
      'Result': 'Positive'
    })
    .call(function() {
      var ds2 = Keen.Dataset.parser('interval')(res[1]);
      this.dataset.appendColumn('Negative', ds2.selectColumn(1).slice(1));
      var ds3 = Keen.Dataset.parser('interval')(res[2]);
      this.dataset.appendColumn('Neutral', ds3.selectColumn(1).slice(1));
    })
    .render();
});



});




var retweet = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
          {
            property_name: "retweeted",
            operator: "eq",
            property_value : "true"
          }
        ]
});

var replies = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate:3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
         {
        "operator": "exists",
        "property_name": "replied_to",
        "property_value": true
         },  
         {
            property_name: "replied_to",
            operator: "ne",
            property_value : null
          }
             
         
        ]
});


var origpost = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
       {
            property_name: "retweeted",
            operator: "eq",
            property_value : "false" 
          },

       {
            property_name: "replied_to",
            operator: "eq",
            property_value : null
          }

        ]
});



var engchart = new Keen.Dataviz()
  .el('#eng_chart')
  .title('Engagement type (last 7 days) ')
  .height(300)
  .type("bar")
  .stacked(true)
  .colors(['red','green','blue'])
  .prepare();

client.run([retweet, replies, origpost ], function(err, res) {
   engchart
    .data(res[0])
    .labelMapping({
      'Result': 'Retweets'
    })
    .call(function() {
      var ds2 = Keen.Dataset.parser('interval')(res[1]);
      this.dataset.appendColumn('Replies', ds2.selectColumn(1).slice(1));
      var ds3 = Keen.Dataset.parser('interval')(res[2]);
      this.dataset.appendColumn('Original post', ds3.selectColumn(1).slice(1));

    })
    .render();
});

var userquery = new Keen.Query("count", {
        group_by: "username",
        refresh_rate: 3600,
        event_collection: "bus5569F17",
        timezone: "US/Eastern",
        timeframe: "this_7_days"
    });

var columnchart = new Keen.Dataviz()
      .chartType('horizontal-bar')
      .el(document.getElementById('column_chart'))
      .height(300)
      .colors(['purple'])
      .title ('Top 10 contributors (last 7 days)');
    client.run(userquery, function(err, res){
        columnchart
        .data(res)
       .parseRequest(this)
        .call(function(){
           this.dataset.sortRows("desc", function(row){
              return row[1];
            });

           this.dataset.filterRows(function(row, index){
             return index < 11;
            });

           })
          .render();
        });

var con1 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
          {
            property_name: "mentions1",
            operator : "not_contains",
            property_value : "None"
          }
        ]
});

var con2 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
          {
            property_name: "hashtag1",
            operator : "not_contains",
            property_value : "None"
          }
        ]
});

var con3 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
          {
            property_name: "urls1",
            operator : "not_contains",
            property_value : "None"
          }
        ]
});


var con4 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  refresh_rate: 3600,
  timezone: "US/Eastern",
  interval: 'daily',
  filters: [
          {
            property_name: "media",
            operator : "not_contains",
            property_value : "false"
          }
        ]
});

var conchart = new Keen.Dataviz()
  .el('#con_chart')
  .title('Content types (last 7 days)')
  .height(300)
  .chartOptions({
axis: {
x: {
type: 'timeseries',
tick: {
count: 4,
format: '%m-%d'
}
}
}
})
  .type("area")
  .stacked(true)
  .colors(['red','green','blue','orange'])
  .prepare();

client.run([con1, con2, con3, con4], function(err, res) {
  conchart
    .data(res[0])
    .labelMapping({
      'Result': 'User mentions'
    })
    .call(function() {
      var ds2 = Keen.Dataset.parser('interval')(res[1]);
      this.dataset.appendColumn('Hashtags', ds2.selectColumn(1).slice(1));
      var ds3 = Keen.Dataset.parser('interval')(res[2]);
      this.dataset.appendColumn('URLs', ds3.selectColumn(1).slice(1));
      var ds4 = Keen.Dataset.parser('interval')(res[3]);
      this.dataset.appendColumn('Media', ds4.selectColumn(1).slice(1));

    })
    .render();
});


Keen.ready(function() {
  var sq2 = new Keen.Query("count", {
     event_collection: "bus5569F17",
     timeframe: 'this_7_days',
     refresh_rate: 3600,
     group_by: "username",
     target_property: 'sentiment_range',
     filters: [
          {
            property_name: "sentiment_range",
            operator : "eq",
            property_value : "positive"
          }
        ]
    });

  var subbarchart = new Keen.Dataviz()
      .type('horizontal-bar')
      .el(document.getElementById('subbar_chart'))
      .height(300)
      .colors(['green'])
      .title  ('Top 10 users with highest number of positive tweets (last 7 days)'); 




  client.run(sq2,  function(err, res) {
       subbarchart
         .data(res)
         .parseRequest(this)
         .call(function(){
             this.dataset.sortRows("desc", function(row){
              return row[1];
            });
            this.dataset.filterRows(function(row, index){
             return index < 11;
            });
           })
       .render();
      });
});

Keen.ready(function() {
  var neq = new Keen.Query("count", {
     event_collection: "bus5569F17",
     timeframe: 'this_7_days',
     timezone: "US/Eastern",
     refresh_rate: 300,
     group_by: "named_entities",
     filters: [
    {
        "operator": "not_contains",
        "property_name": "named_entities",
        "property_value": "None"
    },
    {
        "operator": "exists",
        "property_name": "named_entities",
        "property_value": true
    },
    {
        "operator": "not_contains",
        "property_name": "named_entities",
        "property_value": "none"
    }
]   

 });


  var nechart = new Keen.Dataviz()
      .type('pie')
      .el(document.getElementById('ne_chart'))
      .height(300)
      .title ('Top 10 most frequently mentioned named entities (last 7 days)');


  client.run(neq,  function(err, res) {
       nechart
         .data(res)
         .parseRequest(this)
         .call(function(){
             this.dataset.sortRows("desc", function(row){
              return row[1];
            });
            this.dataset.filterRows(function(row, index){
             return index < 11;
            });
           })
       .render();
      });
});

Keen.ready(function(){
  var tablequery = new Keen.Query("count", {
        group_by: "hashtag1",
        event_collection: "bus5569F17",
        refresh_rate: 3600,
        timeframe: "this_7_days",
        filters: [
          {
            property_name: "hashtag1",
            operator : "not_contains",
            property_value : "None"
          },
  {
            property_name: "hashtag1",
            operator : "not_contains",
            property_value : "bus5569F17"
          },
  {
            property_name: "hashtag1",
            operator : "not_contains",
            property_value : "BUS5569F17"
          }


        ]
    });

   var table = new Keen.Dataviz()
      .chartType('table')
      .el(document.getElementById('hashtag_table'))
      .height(300)
      .title ('Top 10 most frequent hashtags (last 7 days)');
    client.run(tablequery, function(err, res){
        table
        .data(res)
       .parseRequest(this)
        .call(function(){
            this.dataset.updateRow(0, function(value, index){
              return ['Hashtag','Frequency'][index];
            });
            this.dataset.sortRows("desc", function(row){
              return row[1];
            });
            this.dataset.filterRows(function(row, index){
             return index < 11;
            });

           })
          .render();
        });
  });

Keen.ready(function(){

var subq1 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  timezone: "US/Eastern",
  interval: 'daily',
  refresh_rate: 3600,
  target_property: 'subjectivity_range',
  filters: [
          {
            property_name: "subjectivity_range",
            operator : "eq",
            property_value : "subjective"
          }
        ]
});

var subq2 = new Keen.Query("count", {
  event_collection: "bus5569F17",
  timeframe: 'previous_7_days',
  timezone: "US/Eastern",
  interval: 'daily',
  refresh_rate:3600,
  target_property: 'subjectivity_range',
  filters: [
          {
            property_name: "subjectivity_range",
            operator : "eq",
            property_value : "Non subjective"
          }
        ]
});




var subchart = new Keen.Dataviz()
  .el('#sub_chart')
  .title('Subjectivity type (last 7 days)')
  .height(300)
  .type("spline")
  .colors(['blue','pink'])
  .prepare();

client.run([subq1, subq2 ], function(err, res) {
  subchart
    .data(res[0])
    .labelMapping({
      'Result': 'Opinionated'
    })
    .call(function() {
      var ds2 = Keen.Dataset.parser('interval')(res[1]);
      this.dataset.appendColumn('Non opinionated', ds2.selectColumn(1).slice(1));
    })
    .render();
});
});

/*
Keen.ready(function(){

    var retweet_sent = new Keen.Query("count", {
    event_collection: "bus5569F17",
    refresh_rate: 3600,
    filters: [
    {
        "operator": "not_contains",
        "property_name": "sentiment_range",
        "property_value": "null"
    },
    {
        "operator": "not_contains",
        "property_name": "retweeted",
        "property_value":  "null" 
    }
],
    group_by: [
    "sentiment_range","retweeted"
],
    timeframe: "this_7_days",
    timezone: "US/Eastern"
});

   var sent2chart = new Keen.Dataviz()
    .el('#sent2_chart')
    .title('Sentiment by tweet type (last 7 days)')
    .height(300)
    .type("horizontal-bar")
    .chartOptions({isStacked:true})
    .colors(['blue','red','green']);

   client.run([retweet_sent], function(err, res) {
     sent2chart 
      .data(res)
      .labels([ "Neutral Retweet", "Neutral Original", "Postive Retweet", "Positive Original", "Negative Retweet","Negative Original" ])
    
      .call(function() {
      })
      .render();
  });

});

*/

Keen.ready(function() {
  var sentq2 = new Keen.Query("count", {
     event_collection: "bus5569F17",
     timeframe: 'this_7_days',
     refresh_rate: 3600,
     group_by: "username",
     target_property: 'sentiment_range',
     filters: [
          {
            property_name: "sentiment_range",
            operator : "eq",
            property_value : "negative"
          }
        ]
    });

  var sentbarchart = new Keen.Dataviz()
      .type('horizontal-bar')
      .el(document.getElementById('sentbar_chart'))
      .height(300)
      .colors(['red'])
      .title  ('Top 10 users with highest number of negative tweets (last 7 days)');

  client.run(sentq2,  function(err, res) {
       sentbarchart
         .data(res)
         .parseRequest(this)
         .call(function(){
             this.dataset.sortRows("desc", function(row){
              return row[1];
            });
            this.dataset.filterRows(function(row, index){
             return index < 11;
            });
           })
       .render();
      });
});

Keen.ready(function() {
  var mentions = new Keen.Query("count", {
     event_collection: "bus5569F17",
     timeframe: 'this_1_days',
     refresh_rate: 3600,
     group_by: ["mentions1"],
     filters: [
          {
            property_name: "mentions1",
            operator: "ne",
            property_value : "null"
          },
  {
    property_name: "mentions1",
            operator: "not_contains",
            property_value : "None"
        }

     ]    
});

  var mentbarchart = new Keen.Dataviz()
      .type('horizontal-bar')
      .el(document.getElementById('mentions_chart'))
      .height(300)
      .colors(['blue'])
      .title  ('Top 10 user mentioned in others\' tweets  (last 7 days)');


  client.run(mentions,  function(err, res) {
       mentbarchart
         .data(res)
         .parseRequest(this)
         .call(function(){
             this.dataset.sortRows("desc", function(row){
              return row[1];
            });
            this.dataset.filterRows(function(row, index){
             return index < 11;
            });
           })
       .render();
      });
});


Keen.ready(function() {
  var textq = new Keen.Query("extraction", {
     event_collection: "bus5569F17",
     timeframe: 'this_1_days',
     refresh_rate: 3600,
     property_names: ["username","text"],
     timezone:"US/Eastern"
    });

  var textchart = new Keen.Dataviz()
     .el(document.getElementById('text_ext'))
     .height(330)
     .type('table')
     .title('Full text of today\'s tweets')
     .prepare();

  client.run(textq, function(err, res) {
      textchart
      .data(res)
      .parseRequest(this)
      .call(function(){
             this.dataset.sortRows("desc", function(row){
              return row[1];
           });
           this.dataset.filterRows(function(row, index){
             return index < 11;
           });
          })
       .render();
    });
});


</script>
</body>
</html>


